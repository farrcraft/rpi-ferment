// Generated by CoffeeScript 1.6.2
(function() {
  var UserTool, bcrypt, db, mongoose, optimist, tool;

  optimist = require('optimist');

  mongoose = require('mongoose');

  bcrypt = require('bcrypt');

  db = require('../lib/services/db.js');

  require('../lib/orm/user.js');

  UserTool = (function() {
    function UserTool() {}

    UserTool.prototype.run = function(optimist) {
      var argv;

      optimist.usage('Usage: $0 --add --email [email] --password [password]');
      optimist.demand(['email', 'password']);
      argv = optimist.argv;
      if (argv.add) {
        return this.add(argv.email, argv.password);
      }
    };

    false;

    UserTool.prototype.add = function(email, password) {
      var hash, model, salt, saveCallback, user;

      db.establishConnection();
      model = mongoose.model('User');
      salt = bcrypt.genSaltSync(10);
      hash = bcrypt.hashSync(password, salt);
      user = new model();
      user.email = email;
      user.password = password;
      user.salt = salt;
      saveCallback = function(err) {};
      user.save(saveCallback);
      return true;
    };

    return UserTool;

  })();

  tool = new UserTool();

  tool.run(optimist);

}).call(this);
